<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Archive Verification Console</title>
  <style>
    :root {
      --bg: #030305;
      --accent: #7be3b2;
      --text: #cfe8df;
    }
    body {
      background: linear-gradient(180deg, #030305 0%, #071018 100%);
      color: var(--text);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
      padding: 32px;
    }
    .term {
      background: #02030a;
      border: 1px solid rgba(127,255,200,0.06);
      padding: 20px;
      border-radius: 8px;
      max-width: 760px;
      margin: 0 auto;
      box-shadow: 0 8px 40px rgba(0,0,0,0.6);
    }
    h2 { color: var(--accent); margin-top: 0; }
    input, button {
      font-family: inherit;
      font-size: 1rem;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #064;
      background: #041018;
      color: var(--text);
      margin-right: 8px;
    }
    button {
      background: var(--accent);
      color: #000;
      border: 0;
      cursor: pointer;
      font-weight: bold;
    }
    #result {
      margin-top: 14px;
      padding: 10px;
      border-radius: 6px;
      background: #02150e;
      white-space: pre-wrap;
      display: none;
    }
    a {
      color: var(--accent);
      text-decoration: none;
    }
  </style>
</head>
<body>
  <div class="term">
    <h2>Archive Verification Console</h2>
    <p>Input authorization phrase to unlock classified records.</p>
    <input id="phrase" placeholder="enter phrase..." autofocus />
    <button id="check">Submit</button>
    <div id="result"></div>
  </div>

  <script>
// Map of phrases → unlock keys + messages
const UNLOCKS = {
  "found you": {
    hash: "5ea4a2bf3e61a4183c4f17ec122c8cca528fa25c360322e5afc01fd4ce85d6a2", // SHA-256("found you")
    key: "alex",
    msg: "ACCESS GRANTED — Subject file unlocked: CD-11\nReturn to main archive to review."
  },
  "dubious": {
    hash: "2da310051c9f4a25c5a85ef2c81cc38a9c6c853ef72d0b1d50419be01411fa62", // ✅ Correct SHA-256("dubious")
    key: "dennis",
    msg: "ACCESS GRANTED — Subject file unlocked: GC-06\nReturn to main archive to review."
  },
  "korat": {
    hash: "91a2c38e2b113804ef58fa32a758ba8fdf738f799764258b01b11c8ec2f0b9cb", // SHA-256("korat")
    key: "remy",
    msg: "ACCESS GRANTED — Subject file unlocked: WC-04\nReturn to main archive to review."
  },
  "honorbound": {
  hash: "bdf9cf57e1e8cca6828496fa28c6e253e6c803cc462a55adba8aacaaf2eeb43c",
  key: "ivan",
  msg: "ACCESS GRANTED — Subject file unlocked: NT-07\nReturn to main archive to review."
},
  "endearment": {
  hash: "a8f3687cfedd151577cde11a5d4695a46e4cd484eca3ad55871af9b7c8f87585",
  key: "yin",
  msg: "ACCESS GRANTED — Subject file unlocked: MW-15\nReturn to main archive to review."
}
};

async function sha256Hex(text){
  const enc = new TextEncoder();
  const data = enc.encode(text);
  const hashBuffer = await crypto.subtle.digest('SHA-256', data);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  return hashArray.map(b => b.toString(16).padStart(2,'0')).join('');
}

document.getElementById('check').addEventListener('click', async ()=>{
  const input = document.getElementById('phrase').value.trim().toLowerCase();
  const result = document.getElementById('result');
  if(!input) return;

  result.style.display = 'block';
  result.style.color = '#9fe';
  result.textContent = '> verifying input...';

  const hash = await sha256Hex(input);
  const match = Object.values(UNLOCKS).find(u => u.hash === hash);

  if(match){
    // store unlock key
    const unlocked = JSON.parse(localStorage.getItem('delomina_unlocked') || "[]");
    if(!unlocked.includes(match.key)){
      unlocked.push(match.key);
      localStorage.setItem('delomina_unlocked', JSON.stringify(unlocked));
    }
    result.style.color = '#7f7';
    result.textContent = match.msg + "\n\n> Return to index.html to proceed.";
  } else {
    result.style.color = '#f77';
    result.textContent = "ACCESS DENIED — invalid phrase.";
  }
});
</script>
</body>
</html>
