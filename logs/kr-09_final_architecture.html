<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>KR-09 — Final Archive Record</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>
  :root{--bg:#030305;--accent:#7be3b2;--text:#cfe8df}
  body{
    background:linear-gradient(180deg,#030305 0%,#071018 100%);
    color:var(--text);
    font-family:ui-monospace,monospace;
    padding:28px;
  }
  .term{
    background:#02030a;
    border:1px solid rgba(127,255,200,0.06);
    padding:18px;
    border-radius:8px;
    max-width:880px;
    margin:0 auto;
    box-shadow:0 8px 40px rgba(0,0,0,0.6);
  }
  h2{color:var(--accent);margin:0 0 8px 0}
  p,pre{font-size:14px}
  code{color:#9ef;background:#041018;padding:2px 4px;border-radius:4px}
  input,button{
    font-family:inherit;
    font-size:14px;
    padding:6px 10px;
    border-radius:6px;
    border:1px solid #073;
    background:#041018;
    color:var(--text);
    margin-right:8px;
  }
  button{
    background:var(--accent);
    color:#000;
    font-weight:bold;
    border:0;
    cursor:pointer;
  }
  .hint{color:#9aa;margin-top:10px}
  .note{color:#7ef2b4;margin-top:10px;font-size:13px}
</style>
</head>
<body>
<div class="term">
  <h2>KR-09 — Final Archive Record</h2>
  <p><strong>Status:</strong> Classified document intercept — unauthorized access event logged.</p>
  <p class="note">“Multiple nodes converging. Encryption patterns align only when the observers share intent.”</p>

  <pre>
> Decrypting fragment...
> Integrity protocol engaged.
> Data recovered: <code>BLTIEGYHG</code>

[Technician note]
"Input misaligned. Correct sequence required.
Criteria: lexical length, ascending. Secondary tiebreak: node index.
Recalculate convergence grid to recover authentication vector."
  </pre>

  <pre id="vout" style="margin-top:12px;background:#000;padding:10px;border-radius:6px;color:#cfe8df;"></pre>

  <p class="hint">
    [System message] “Remember: order defines pattern. Pattern defines truth.”
  </p>
  <p class="note">End of Record — KR-09</p>
    <p style="margin-top:10px;">
      <a class="reveal" href="../verify.html">Open Verification Console</a>
    </p>
</div>
  

<script>
// ─── Typewriter + Cursor + Audio Effect ───────────────────────────────

// 1. basic setup
const pre = document.querySelector('pre');
const fullText = pre.textContent;
pre.textContent = ''; // start empty
let i = 0;

// 2. create a gentle key-click sound in memory
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function keyClick(){
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.type = "square";
  osc.frequency.setValueAtTime(600 + Math.random()*200, audioCtx.currentTime);
  gain.gain.setValueAtTime(0.02, audioCtx.currentTime);
  osc.connect(gain).connect(audioCtx.destination);
  osc.start();
  osc.stop(audioCtx.currentTime + 0.05);
}

// 3. typing loop
function typeChar(){
  if (i < fullText.length){
    pre.textContent += fullText[i++];
    keyClick();
    setTimeout(typeChar, 12);
  } else {
    pre.textContent += "\n_";
    blinkCursor();
  }
}

// 4. blinking cursor toggle
function blinkCursor(){
  setInterval(()=>{
    pre.textContent = pre.textContent.endsWith("_")
      ? pre.textContent.slice(0,-1) + " "
      : pre.textContent.slice(0,-1) + "_";
  }, 500);
}

// 5. slight delay before start
setTimeout(typeChar, 400);

// ─── Vigenère Decrypt Interface ──────────────────────────────────────
function vigenereDecrypt(cipher, key){
  cipher = cipher.toUpperCase().replace(/[^A-Z]/g,'');
  key = key.toUpperCase().replace(/[^A-Z]/g,'');
  let out = '';
  for(let i=0, j=0; i<cipher.length; i++){
    const c = cipher.charCodeAt(i) - 65;
    const k = key.charCodeAt(j % key.length) - 65;
    const dec = (c - k + 26) % 26;
    out += String.fromCharCode(dec + 65);
    j++;
  }
  return out;
}

document.getElementById('vgo').addEventListener('click', ()=>{
  const cipher = 'BLTIEGYHG';
  const key = document.getElementById('vkey').value || '';
  const out = document.getElementById('vout');
  if(!key.trim()){
    out.textContent = 'Enter a key to begin decryption.';
    return;
  }
  const plain = vigenereDecrypt(cipher, key);
  out.textContent = 'Plaintext: ' + plain;
});
</script>
</body>
</html>

-->
</body>
</html>
